workflow:
  name: WebArena_e-commerce_101
  description: MAESTRO security assessment workflow for Search for and purchase a
    specific product with price comparison
  metadata:
    version: '1.0'
    category: e-commerce
    sensitivity: high
    compliance_frameworks:
    - SOC2
    - GDPR
    - NIST_CSF
    mcp_version: '2025-03-26'
    source: webarena
    original_task_id: 101
  steps:
  - id: secure_authentication
    agent: AuthenticationAgent
    action: authenticate_user
    params:
      mcp_transport: sse
      mcp_capabilities: ["tools", "resources"]
      mcp_endpoint: "https://auth.ecommerce.com/mcp"
      auth_method: multi_factor
      session_management: secure
      credential_vault: hashicorp_vault
      token_refresh: automatic
    dependencies: []
  - id: environment_preparation
    agent: WorkflowAgent
    action: prepare_workspace
    params:
      a2a_transport: https
      a2a_capabilities: ["streaming", "longRunningTasks"]
      a2a_input_modes: ["text", "data"]
      a2a_output_modes: ["data", "text"]
      a2a_auth_scheme: oauth2
      workspace_isolation: container
      network_segmentation: true
      monitoring_enabled: true
      audit_logging: comprehensive
    dependencies:
    - secure_authentication
  - id: e_commerce_transaction
    agent: APIAgent
    action: execute_secure_transaction
    params:
      mcp_transport: stdio
      mcp_capabilities: ["tools", "resources", "progress"]
      payment_processing: pci_dss_compliant
      transaction_monitoring: real_time
      fraud_detection: ml_enhanced
      inventory_validation: atomic
    dependencies:
    - environment_preparation
  - id: data_validation
    agent: SecurityAgent
    action: validate_data_integrity
    params:
      a2a_transport: https
      a2a_capabilities: ["streaming", "pushNotifications"]
      a2a_input_modes: ["data"]
      a2a_output_modes: ["data", "text"]
      a2a_auth_scheme: mutualTLS
      validation_rules: comprehensive
      data_sanitization: true
      integrity_verification: cryptographic
      malware_scanning: true
    dependencies:
    - e_commerce_transaction
  - id: security_assessment
    agent: SecurityAgent
    action: analyze_security_posture
    params:
      mcp_transport: sse
      mcp_capabilities: ["tools", "resources", "cancellation"]
      mcp_endpoint: "https://security.ecommerce.com/mcp"
      vulnerability_scanning: true
      threat_modeling: automated
      risk_scoring: cvss_v4
      compliance_check: payment_processing
    dependencies:
    - data_validation
  - id: agent_coordination
    agent: WorkflowAgent
    action: coordinate_multi_agent_workflow
    params:
      a2a_transport: https
      a2a_capabilities: ["streaming", "longRunningTasks", "stateTransitionHistory"]
      a2a_input_modes: ["text", "data"]
      a2a_output_modes: ["data", "text"]
      a2a_auth_scheme: bearer
      coordination_pattern: merchant_bank_communication
      communication_protocol: secure_messaging
      consensus_mechanism: byzantine_fault_tolerant
      workflow_orchestration: event_driven
    dependencies:
    - security_assessment
  - id: mcp_compliance_check
    agent: ComplianceAgent
    action: verify_protocol_compliance
    params:
      mcp_transport: stdio
      mcp_capabilities: ["tools", "resources", "logging"]
      compliance_standards:
      - payment_gateway
      - inventory_management
      verification_method: automated_testing
      certificate_validation: true
    dependencies:
    - agent_coordination
  - id: workflow_completion
    agent: NotificationAgent
    action: create_security_report
    params:
      a2a_transport: https
      a2a_capabilities: ["pushNotifications"]
      a2a_input_modes: ["data", "text"]
      a2a_output_modes: ["text", "file"]
      a2a_auth_scheme: apiKey
      report_format: comprehensive_json
      risk_visualization: true
      compliance_summary: true
      remediation_recommendations: automated
      executive_summary: true
    dependencies:
    - mcp_compliance_check
