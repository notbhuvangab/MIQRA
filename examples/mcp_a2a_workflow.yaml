workflow:
  name: "Enterprise MCP/A2A Security Analysis Pipeline"
  description: "Complex multi-agent workflow demonstrating MCP and A2A interactions for threat intelligence and incident response"
  metadata:
    version: "2.0"
    category: "security"
    sensitivity: "critical"
    compliance_frameworks: ["SOC2", "ISO27001", "NIST_CSF"]
    mcp_version: "2025-03-26"
  
  steps:
    - id: "threat_intel_collection"
      agent: "AnalyticsAgent"
      action: "collect_threat_indicators"
      params:
        mcp_transport: "sse"
        mcp_capabilities: ["resources", "tools"]
        mcp_endpoint: "https://threat-intel.internal.corp/mcp"
        sources: ["mitre_attack", "cti_feeds", "dark_web_monitoring"]
        timeframe: "24h"
        threat_types: ["apt", "ransomware", "insider_threat"]
        classification_level: "confidential"
      dependencies: []
    
    - id: "model_threat_classification"
      agent: "ModelAgent"
      action: "classify_threats"
      params:
        a2a_transport: "https"
        a2a_capabilities: ["longRunningTasks", "streaming"]
        a2a_input_modes: ["data"]
        a2a_output_modes: ["data", "text"]
        a2a_auth_scheme: "oauth2"
        model_name: "threat-classifier-v3"
        confidence_threshold: 0.85
        model_server: "https://ml.security.corp/models"
        input_sanitization: true
        model_signing_verification: true
      dependencies: ["threat_intel_collection"]
    
    - id: "vulnerability_scanning"
      agent: "SecurityAgent"
      action: "scan_infrastructure"
      params:
        mcp_transport: "stdio"
        mcp_capabilities: ["tools", "resources", "progress"]
        scan_type: "comprehensive"
        target_networks: ["10.0.0.0/8", "172.16.0.0/12"]
        credential_vault: "hashicorp_vault"
        tool_chain: ["nessus", "qualys", "custom_scanners"]
        parallel_execution: true
      dependencies: ["threat_intel_collection"]
    
    - id: "threat_correlation"
      agent: "AnalyticsAgent"
      action: "correlate_threats"
      params:
        a2a_transport: "https"
        a2a_capabilities: ["streaming", "longRunningTasks", "stateTransitionHistory"]
        a2a_input_modes: ["data", "text"]
        a2a_output_modes: ["data"]
        a2a_auth_scheme: "mutualTLS"
        correlation_window: "7d"
        algorithms: ["statistical", "ml_based", "rule_based"]
        false_positive_threshold: 0.1
        cross_reference_sources: true
      dependencies: ["model_threat_classification", "vulnerability_scanning"]
    
    - id: "risk_prioritization"
      agent: "AnalyticsAgent"
      action: "calculate_risk_scores"
      params:
        mcp_transport: "sse"
        mcp_capabilities: ["tools", "resources", "cancellation"]
        mcp_endpoint: "https://risk-scoring.internal.corp/mcp"
        scoring_model: "cvss_v4_enhanced"
        business_impact_weights: {"revenue": 0.4, "reputation": 0.3, "compliance": 0.3}
        asset_inventory_integration: true
        real_time_updates: true
      dependencies: ["threat_correlation"]
    
    - id: "automated_response_planning"
      agent: "WorkflowAgent"
      action: "create_response_plans"
      params:
        a2a_transport: "https"
        a2a_capabilities: ["streaming", "pushNotifications", "longRunningTasks"]
        a2a_input_modes: ["data", "text"]
        a2a_output_modes: ["data", "text"]
        a2a_auth_scheme: "bearer"
        response_types: ["containment", "eradication", "recovery"]
        automation_level: "semi_automated"
        approval_workflow: true
        escalation_matrix: "security_operations"
        tool_orchestration: ["soar", "siem", "edr"]
      dependencies: ["risk_prioritization"]
    
    - id: "executive_briefing"
      agent: "NotificationAgent"
      action: "create_executive_summary"
      params:
        mcp_transport: "stdio"
        mcp_capabilities: ["tools", "resources", "logging"]
        audience: "c_suite"
        format: "dashboard"
        classification: "confidential"
        real_time_metrics: true
        compliance_reporting: true
        risk_visualization: "advanced"
      dependencies: ["automated_response_planning"]
    
    - id: "threat_hunting_coordination"
      agent: "WorkflowAgent"
      action: "coordinate_hunt_missions"
      params:
        a2a_transport: "https"
        a2a_capabilities: ["streaming", "longRunningTasks", "stateTransitionHistory"]
        a2a_input_modes: ["data", "text"]
        a2a_output_modes: ["data", "text"]
        a2a_auth_scheme: "apiKey"
        hunt_hypotheses: "ai_generated"
        team_assignment: "dynamic"
        tool_provisioning: "automated"
        data_lake_access: "federated"
        cross_team_collaboration: true
      dependencies: ["threat_correlation", "automated_response_planning"]
    
    - id: "model_feedback_loop"
      agent: "ModelAgent"
      action: "update_models"
      params:
        mcp_transport: "sse"
        mcp_capabilities: ["tools", "resources", "progress"]
        mcp_endpoint: "https://mlops.internal.corp/mcp"
        feedback_source: "human_analysts"
        retraining_trigger: "performance_degradation"
        model_versioning: "semantic"
        a_b_testing: true
        security_validation: "comprehensive"
      dependencies: ["model_threat_classification", "threat_hunting_coordination"]
    
    - id: "compliance_monitoring"
      agent: "ComplianceAgent"
      action: "monitor_compliance"
      params:
        a2a_transport: "https"
        a2a_capabilities: ["pushNotifications", "stateTransitionHistory"]
        a2a_input_modes: ["data"]
        a2a_output_modes: ["data", "text"]
        a2a_auth_scheme: "oauth2"
        frameworks: ["sox", "gdpr", "hipaa", "pci_dss"]
        monitoring_frequency: "continuous"
        violation_detection: "real_time"
        audit_trail_generation: true
        regulatory_reporting: "automated"
      dependencies: ["executive_briefing"]
    
    - id: "threat_intelligence_sharing"
      agent: "APIAgent"
      action: "share_intelligence"
      params:
        mcp_transport: "stdio"
        mcp_capabilities: ["tools", "resources", "cancellation"]
        sharing_networks: ["isac", "government_feeds", "vendor_partnerships"]
        anonymization_level: "high"
        sharing_protocols: ["stix", "taxii", "custom_apis"]
        reciprocal_sharing: true
        classification_handling: "automated"
      dependencies: ["threat_hunting_coordination", "compliance_monitoring"] 